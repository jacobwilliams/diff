<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
   <meta name="description" content="Numerical Differentiation of a User Defined Function">
    <meta name="author" content="Jacob Williams" >
    <link rel="icon" href="./favicon.png">

    <title> diff </title>

    <link href="./css/bootstrap.min.css" rel="stylesheet">
    <link href="./css/pygments.css" rel="stylesheet">
    <link href="./css/font-awesome.min.css" rel="stylesheet">
    <link href="./css/local.css" rel="stylesheet">
    <link  href="./tipuesearch/tipuesearch.css" rel="stylesheet">

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    
    <script src="./js/jquery-2.1.3.min.js"></script>
    <script src="./js/svg-pan-zoom.min.js"></script>

  </head>

  <body>

    <!-- Fixed navbar -->
    <nav class="navbar navbar-inverse navbar-fixed-top">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="./index.html">diff </a>
        </div>
        <div id="navbar" class="navbar-collapse collapse">
          <ul class="nav navbar-nav">
            <li class="dropdown hidden-xs visible-sm visible-md hidden-lg">
              <a href="#" class="dropdown-toggle"
              data-toggle="dropdown" role="button"
              aria-haspopup="true"
     aria-expanded="false">Contents <span class="caret"></span></a>
        <ul class="dropdown-menu">
            <li><a href="./sourcefile/diff_module.f90.html">Source File</a></li>
            <li><a href="./lists/modules.html">Modules</a></li>
            <li><a href="./lists/procedures.html">Procedures</a></li>
            <li><a href="./lists/absint.html">Abstract Interfaces</a></li>
                   <li><a href="./lists/types.html">Derived Types</a></li>
       
            </ul>
        
            </li>
<li class="visible-xs hidden-sm visible-lg"><a href="./sourcefile/diff_module.f90.html">Source File</a></li>
<li class="visible-xs hidden-sm visible-lg"><a href="./lists/modules.html">Modules</a></li>
<li class="visible-xs hidden-sm visible-lg"><a href="./lists/procedures.html">Procedures</a></li>
<li class="visible-xs hidden-sm visible-lg"><a href="./lists/absint.html">Abstract Interfaces</a></li>
                             <li class="visible-xs hidden-sm visible-lg"><a href="./lists/types.html">Derived Types</a></li>
          </ul>
        <form action="./search.html" class="navbar-form navbar-right" role="search">
        <div class="form-group">
          <input type="text" class="form-control" placeholder="Search" name="q" id="tipue_search_input" autocomplete="off" required>
        </div>
<!--
        <button type="submit" class="btn btn-default">Submit</button>
-->
        </form>
        </div><!--/.nav-collapse -->
      </div>
    </nav>

    <div class="container">
      <!-- Main component for a primary marketing message or call to action -->
      <div class="jumbotron">
        <p>Numerical Differentiation of a User Defined Function</p>
	<p> Find us on&hellip;</p>
        <p>
          <a class="btn btn-lg btn-primary" href="https://github.com/jacobwilliams/diff" role="button">GitHub</a>
        </p>
      </div>

      <div class="row" id='text'>
        <div class="col-md-8">
          <h1>diff</h1>
          <h1>diff</h1>
<p>Numerical Differentiation of a User Defined Function</p>
<h3>Status</h3>
<p><a href="https://github.com/jacobwilliams/diff/releases/latest"><img alt="GitHub release" src="https://img.shields.io/github/release/jacobwilliams/diff.svg"></a>
<a href="https://github.com/jacobwilliams/diff/actions"><img alt="Build Status" src="https://github.com/jacobwilliams/diff/actions/workflows/CI.yml/badge.svg"></a>
<a href="https://codecov.io/gh/jacobwilliams/diff"><img alt="codecov" src="https://codecov.io/gh/jacobwilliams/diff/branch/master/graph/badge.svg"></a>
<a href="https://github.com/jacobwilliams/diff/commits/master"><img alt="last-commit" src="https://img.shields.io/github/last-commit/jacobwilliams/diff"></a></p>
<h3>Overview</h3>
<p>This code is a modern Fortran update of the DIFF subroutine found <a href="ftp://math.nist.gov/pub/repository/diff/">here</a>.</p>
<p>The DIFF subroutine computes the first, second or third derivative of a real function of a single real variable.  The user provides the function, a real interval <code>[xmin,xmax]</code> on which the function is continuous, and a point <code>x0</code> lying in <code>[xmin,xmax]</code>. Optionally, the user may provide an estimate of the absolute or relative accuracy of function evaluation in <code>[xmin,xmax]</code> and the absolute or relative error tolerance that is acceptable in the computed derivative. The subroutine returns the computed derivative and an estimated upper bound on the absolute error of the computed derivative. The method used is Neville's process of extrapolating from a sequence of interpolating polynomials with interpolating points distributed symmetrically about <code>x0</code> or, if this is not possible, to one side of <code>x0</code>.</p>
<p>The original sourcecode was produced by the National Bureau of Standards, and is presumed to be in the public domain.</p>
<h3>Compiling</h3>
<p>A <a href="https://github.com/fortran-lang/fpm">Fortran Package Manager</a> manifest file is included, so that the library and test cases can be compiled with FPM. For example:</p>
<div class="codehilite"><pre><span></span><code>fpm build --profile release
fpm test --profile release
</code></pre></div>

<p>To use <code>diff</code> within your fpm project, add the following to your <code>fpm.toml</code> file:</p>
<div class="codehilite"><pre><span></span><code><span class="k">[dependencies]</span><span class="w"></span>
<span class="n">diff</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">git</span><span class="o">=</span><span class="s">&quot;https://github.com/jacobwilliams/diff.git&quot;</span><span class="w"> </span><span class="p">}</span><span class="w"></span>
</code></pre></div>

<h3>Example Usage</h3>
<div class="codehilite"><pre><span></span><code><span class="w">    </span><span class="k">program </span><span class="n">example</span><span class="w"></span>

<span class="w">    </span><span class="k">use </span><span class="n">diff_module</span><span class="w"></span>
<span class="w">    </span><span class="k">use </span><span class="n">iso_fortran_env</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">wp</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">real64</span><span class="w"> </span><span class="c">!use double precision</span>

<span class="w">    </span><span class="k">implicit none</span>

<span class="k">    </span><span class="kt">integer</span><span class="p">,</span><span class="k">parameter</span><span class="w">  </span><span class="kd">::</span><span class="w"> </span><span class="n">iord</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="w">    </span><span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">),</span><span class="k">parameter</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">x0</span><span class="w">    </span><span class="o">=</span><span class="w"> </span><span class="mf">0.12345_wp</span><span class="w"></span>
<span class="w">    </span><span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">),</span><span class="k">parameter</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">xmin</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="mf">0.0_wp</span><span class="w"></span>
<span class="w">    </span><span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">),</span><span class="k">parameter</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">xmax</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="mf">1.0_wp</span><span class="w"></span>
<span class="w">    </span><span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">),</span><span class="k">parameter</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">eps</span><span class="w">   </span><span class="o">=</span><span class="w"> </span><span class="mf">1.0e-9_wp</span><span class="w"></span>
<span class="w">    </span><span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">),</span><span class="k">parameter</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">acc</span><span class="w">   </span><span class="o">=</span><span class="w"> </span><span class="mf">0.0_wp</span><span class="w"></span>

<span class="w">    </span><span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">deriv</span><span class="p">,</span><span class="w"> </span><span class="n">error</span><span class="w"></span>
<span class="w">    </span><span class="kt">integer</span><span class="w">  </span><span class="kd">::</span><span class="w"> </span><span class="n">ifail</span><span class="w"></span>
<span class="w">    </span><span class="k">type</span><span class="p">(</span><span class="n">diff_func</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">d</span><span class="w"></span>

<span class="w">    </span><span class="k">call </span><span class="n">d</span><span class="p">%</span><span class="n">set_function</span><span class="p">(</span><span class="n">sin_func</span><span class="p">)</span><span class="w"> </span><span class="c">!set function</span>
<span class="w">    </span><span class="k">call </span><span class="n">d</span><span class="p">%</span><span class="n">compute_derivative</span><span class="p">(</span><span class="n">iord</span><span class="p">,</span><span class="n">x0</span><span class="p">,</span><span class="n">xmin</span><span class="p">,</span><span class="n">xmax</span><span class="p">,</span><span class="n">eps</span><span class="p">,</span><span class="n">acc</span><span class="p">,</span><span class="n">deriv</span><span class="p">,</span><span class="n">error</span><span class="p">,</span><span class="n">ifail</span><span class="p">)</span><span class="w"></span>

<span class="w">    </span><span class="k">write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="s1">&#39;(A)&#39;</span><span class="p">)</span><span class="w"> </span><span class="s1">&#39;&#39;</span><span class="w"></span>
<span class="w">    </span><span class="k">write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="s1">&#39;(A,I5)&#39;</span><span class="p">)</span><span class="w">     </span><span class="s1">&#39;ifail                :&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">ifail</span><span class="w"></span>
<span class="w">    </span><span class="k">write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="s1">&#39;(A,E25.16)&#39;</span><span class="p">)</span><span class="w"> </span><span class="s1">&#39;estimated derivative :&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">deriv</span><span class="w"></span>
<span class="w">    </span><span class="k">write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="s1">&#39;(A,E25.16)&#39;</span><span class="p">)</span><span class="w"> </span><span class="s1">&#39;actual derivative    :&#39;</span><span class="p">,</span><span class="w"> </span><span class="nb">cos</span><span class="p">(</span><span class="n">x0</span><span class="p">)</span><span class="w"></span>
<span class="w">    </span><span class="k">write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="s1">&#39;(A,E25.16)&#39;</span><span class="p">)</span><span class="w"> </span><span class="s1">&#39;estimated error      :&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">error</span><span class="w"></span>
<span class="w">    </span><span class="k">write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="s1">&#39;(A,E25.16)&#39;</span><span class="p">)</span><span class="w"> </span><span class="s1">&#39;actual error         :&#39;</span><span class="p">,</span><span class="w"> </span><span class="nb">cos</span><span class="p">(</span><span class="n">x0</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">deriv</span><span class="w"></span>
<span class="w">    </span><span class="k">write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="s1">&#39;(A)&#39;</span><span class="p">)</span><span class="w"> </span><span class="s1">&#39;&#39;</span><span class="w"></span>

<span class="w">    </span><span class="k">contains</span>

<span class="k">        function </span><span class="n">sin_func</span><span class="p">(</span><span class="n">me</span><span class="p">,</span><span class="n">x</span><span class="p">)</span><span class="w"> </span><span class="k">result</span><span class="p">(</span><span class="n">fx</span><span class="p">)</span><span class="w"></span>

<span class="w">        </span><span class="k">implicit none</span>

<span class="k">        class</span><span class="p">(</span><span class="n">diff_func</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">me</span><span class="w"></span>
<span class="w">        </span><span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">x</span><span class="w"></span>
<span class="w">        </span><span class="kt">real</span><span class="p">(</span><span class="n">wp</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">fx</span><span class="w"></span>

<span class="w">        </span><span class="n">fx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">sin</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="w"></span>

<span class="w">        </span><span class="k">end function </span><span class="n">sin_func</span><span class="w"></span>

<span class="w">    </span><span class="k">end program </span><span class="n">example</span><span class="w"></span>
</code></pre></div>

<p>Which produces:</p>
<div class="codehilite"><pre><span></span><code><span class="n">ifail</span><span class="w">                </span><span class="o">:</span><span class="w">   </span><span class="mi">0</span><span class="w"></span>
<span class="n">estimated</span><span class="w"> </span><span class="n">derivative</span><span class="w"> </span><span class="o">:</span><span class="w">   </span><span class="mf">0.9923897210998529</span><span class="n">E</span><span class="o">+</span><span class="mi">00</span><span class="w"></span>
<span class="n">actual</span><span class="w"> </span><span class="n">derivative</span><span class="w">    </span><span class="o">:</span><span class="w">   </span><span class="mf">0.9923897211114882</span><span class="n">E</span><span class="o">+</span><span class="mi">00</span><span class="w"></span>
<span class="n">estimated</span><span class="w"> </span><span class="n">error</span><span class="w">      </span><span class="o">:</span><span class="w">   </span><span class="mf">0.5805992701806732</span><span class="n">E</span><span class="o">-</span><span class="mi">09</span><span class="w"></span>
<span class="n">actual</span><span class="w"> </span><span class="n">error</span><span class="w">         </span><span class="o">:</span><span class="w">   </span><span class="mf">0.1163524832037410</span><span class="n">E</span><span class="o">-</span><span class="mi">10</span><span class="w"></span>
</code></pre></div>

<h3>Documentation</h3>
<ul>
<li>The API documentation for the current <code>master</code> branch can be found <a href="https://jacobwilliams.github.io/diff/">here</a>.  This is generated by processing the source files with <a href="https://github.com/Fortran-FOSS-Programmers/ford">FORD</a>.</li>
</ul>
<h3>Notes</h3>
<p>Alan Miller's <a href="http://jblevins.org/mirror/amiller/to_f90.f90">to_f90</a> program was used to assist in the conversion to modern Fortran.</p>
<h3>See also</h3>
<ul>
<li>DIFF has been incorporated into the <a href="https://github.com/jacobwilliams/NumDiff">NumDiff</a> library.</li>
</ul>
        </div>
        <div class="col-md-4">
	  <div class="well">
          <h2>Developer Info</h2>
          <h4>Jacob Williams</h4>
          
            <div class="text-center"><div class="btn-group" role="group">
              <a class="btn btn-lg btn-primary" href="https://github.com/jacobwilliams"><i class="fa fa-github fa-lg"></i></a>
            </div></div>
       </div>
       </div>
      </div>
      <div class="row">
        <div class="col-xs-6 col-sm-3">
              <h3>Source Files</h3>
              <ul>                    <li><a href='./sourcefile/diff_module.f90.html'>diff_module.f90</a></li>
</ul>
          </div>
		  <div class="col-xs-6 col-sm-3">
              <h3>Modules</h3>
              <ul>                    <li><a href='./module/diff_module.html'>diff_module</a></li>
</ul>
          </div>
		  <div class="col-xs-6 col-sm-3">
              <h3>Procedures</h3>
              <ul>                    <li><a href='./proc/diff.html'>diff</a></li>
                    <li><a href='./proc/faccur.html'>faccur</a></li>
                    <li><a href='./proc/set_function.html'>set_function</a></li>
</ul>
          </div>
		  <div class="col-xs-6 col-sm-3">
              <h3>Derived Types</h3>
              <ul>                    <li><a href='./type/diff_func.html'>diff_func</a></li>
</ul>
          </div>
      </div>
    <hr>    
    </div> <!-- /container -->
    <footer>
      <div class="container">
      <div class="row">
        <div class="col-xs-6 col-md-6"><p>diff was developed by Jacob Williams<br>&copy; 2022 
</p>
        </div>
        <div class="col-xs-6 col-md-6">
          <p class="text-right">
            Documentation generated by 
            <a href="https://github.com/Fortran-FOSS-Programmers/ford">FORD</a>
          </p>
        </div>
      </div>
      <br>
      </div> <!-- /container -->    
    </footer>

    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
<!--
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
-->
    <script src="./js/bootstrap.min.js"></script>
    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <script src="./js/ie10-viewport-bug-workaround.js"></script>

    <!-- MathJax JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },
        jax: ['input/TeX','input/MathML','output/HTML-CSS'],
        extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']
      });
    </script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script src="./tipuesearch/tipuesearch_content.js"></script>
    <script src="./tipuesearch/tipuesearch_set.js"></script>
    <script src="./tipuesearch/tipuesearch.js"></script>
    
  </body>
</html>